<!doctype html>
<!--[if IE 6]>
<html id="ie6" lang="zh-CN">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="zh-CN">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="zh-CN">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="zh-CN">
 <!--<![endif]-->
 <head>      
  <link rel="stylesheet" type="text/css" media="all" href="stylesheets/style.css">     
  <link rel="stylesheet" id="codebox-css" href="stylesheets/codebox.css" type="text/css" media="screen">             
 </head> 
 <body class="single single-post postid-58 single-format-standard content-sidebar"> 
  <div id="page" class="hfeed"> 
   <header id="branding" role="banner"> 
    <hgroup> 
     <h1 id="site-title"><span><a href="http://codelifeliwan.github.io/" title="Code_Life_LiWan" rel="home">Code_Life_LiWan</a></span></h1> 
     <h2 id="site-description">My heart will go on and on…</h2> 
    </hgroup>  
    <!-- #access --> 
   </header>
   <!-- #branding --> 
   <div id="main" class="clearfix"> 
    <div id="primary"> 
     <div id="content" role="main"> 
      <!-- #nav-single --> 
      <article id="post-58" class="post-58 post type-post status-publish format-standard hentry category-qt tag-qt-2"> 
       <header class="entry-header"> 
        <h1 class="entry-title">Qt&nbsp;—&nbsp;spreadsheet&nbsp;简易电子表格</h1> 
        <div class="entry-meta"> 
         <span class="sep">Posted on </span>
         <a href="http://codelifeliwan.github.io/?p=58" title="下午 12:06" rel="bookmark"><time class="entry-date" datetime="2011-06-18T12:06:43+00:00" pubdate>18 六月, 2011</time></a>
         <span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://codelifeliwan.github.io/?author=1" title="View all posts by wanli" rel="author">wanli</a></span></span> 
         <span class="sep"> — </span> 
         <span class="comments-link"> <a href="http://codelifeliwan.github.io/?p=58#respond" title="Comment on Qt&nbsp;—&nbsp;spreadsheet&nbsp;简易电子表格">No Comments ↓</a> </span> 
        </div>
        <!-- .entry-meta --> 
       </header>
       <!-- .entry-header --> 
       <div class="entry-content">
        <div class="entry-content"> 
         <p> 在书上抄的代码，这么长，终于抄完了啊！！以后童鞋们不用自己再抄了！！！由于字数限制，会分几个部分发。</p> 
         <div>
           //spreadsheet.h 
         </div> 
         <div> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000080;">#ifndef</span><span style=" color:#c0c0c0;"> </span>SPREADSHEET_H
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000080;">#define</span><span style=" color:#c0c0c0;"> </span>SPREADSHEET_H
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000080;">#include</span><span style=" color:#008000;">&lt;QTableWidget&gt;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">class</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">class</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">SpreadsheetCompare</span><span style=" color:#000000;">;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">class</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Spreadsheet</span><span style=" color:#000000;">:</span><span style=" color:#808000;">public</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QTableWidget</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">{</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Q_OBJECT</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">public</span><span style=" color:#000000;">:</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Spreadsheet</span><span style=" color:#000000;">(</span><span style=" color:#800080;">QWidget</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span>parent<span style=" color:#000000;">=</span><span style=" color:#000080;">0</span><span style=" color:#000000;">);</span>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span>autoRecalculate<span style=" color:#000000;">()</span><span style=" color:#808000;">const</span><span style=" color:#000000;">{</span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span>autoRecalculate<span style=" color:#000000;">();}</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span>currentLocation<span style=" color:#000000;">()</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span>currentFormula<span style=" color:#000000;">()</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QTableWidgetSelectionRan<wbr>ge</span><span style=" color:#c0c0c0;"> </span>selectedRange<span style=" color:#000000;">()</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>clear<span style=" color:#000000;">();</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span>readFile<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>fileName<span style=" color:#000000;">);</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span>writeFile<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>fileName<span style=" color:#000000;">);</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>sort<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">SpreadsheetCompare</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>compare<span style=" color:#000000;">);</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">public</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">slots</span><span style=" color:#000000;">:</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>cut<span style=" color:#000000;">();</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>copy<span style=" color:#000000;">();</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>paste<span style=" color:#000000;">();</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>del<span style=" color:#000000;">();</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>selectCurrentRow<span style=" color:#000000;">();</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>selectCurrentColumn<span style=" color:#000000;">();</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>recalculate<span style=" color:#000000;">();</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>setAutoRecalculate<span style=" color:#000000;">(</span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span>a<span style=" color:#000000;">);</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>findNext<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>str<span style=" color:#000000;">,</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">CaseSensitivity</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">);</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>findPrevious<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>str<span style=" color:#000000;">,</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">CaseSensitivity</span><span style=" color:#c0c0c0;"> </span>cs<span style=" color:#000000;">);</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">signals</span><span style=" color:#000000;">:</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>modified<span style=" color:#000000;">();</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">private</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">slots</span><span style=" color:#000000;">:</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>somethingChanged<span style=" color:#000000;">();</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">private</span><span style=" color:#000000;">:</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">enum</span><span style=" color:#000000;">{</span><span style=" color:#800080;">MagicNumber</span><span style=" color:#000000;">=</span><span style=" color:#000080;">0x7F51C883</span><span style=" color:#000000;">,</span><span style=" color:#800080;">RowCount</span><span style=" color:#000000;">=</span><span style=" color:#000080;">999</span><span style=" color:#000000;">,</span><span style=" color:#800080;">ColumnCount</span><span style=" color:#000000;">=</span><span style=" color:#000080;">26</span><span style=" color:#000000;">};</span>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span>cell<span style=" color:#000000;">(</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span>row<span style=" color:#000000;">,</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span>column<span style=" color:#000000;">)</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span>text<span style=" color:#000000;">(</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span>row<span style=" color:#000000;">,</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span>column<span style=" color:#000000;">)</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span>formula<span style=" color:#000000;">(</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span>row<span style=" color:#000000;">,</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span>column<span style=" color:#000000;">)</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>setFormula<span style=" color:#000000;">(</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span>row<span style=" color:#000000;">,</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span>column<span style=" color:#000000;">,</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>formula<span style=" color:#000000;">);</span>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">autoRecalc</span><span style=" color:#000000;">;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">};</span>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">class</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">SpreadsheetCompare</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">{</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">public</span><span style=" color:#000000;">:</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">operator</span><span style=" color:#000000;">()(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QStringList</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>row1<span style=" color:#000000;">,</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QStringList</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>row2<span style=" color:#000000;">)</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">enum</span><span style=" color:#000000;">{</span><span style=" color:#800080;">KeyCount</span><span style=" color:#000000;">=</span><span style=" color:#000080;">3</span><span style=" color:#000000;">};</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">Keys</span><span style=" color:#000000;">[</span><span style=" color:#800080;">KeyCount</span><span style=" color:#000000;">];</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">ascending</span><span style=" color:#000000;">[</span><span style=" color:#800080;">KeyCount</span><span style=" color:#000000;">];</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">};</span>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000080;">#endif</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">//</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">SPREADSHEET_H</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#008000;"><br></span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#008000;">//cell.h</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#008000;">
</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#008000;"><span style=" color:#000080;">#ifndef</span><span style=" color:#c0c0c0;"> </span>CELL_H</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000080;">#define</span><span style=" color:#c0c0c0;"> </span>CELL_H
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000080;">#include</span><span style=" color:#008000;">&lt;QTableWidgetItem&gt;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">class</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">:</span><span style=" color:#808000;">public</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QTableWidgetItem</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">public</span><span style=" color:#000000;">:</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QTableWidgetItem</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span><span style=" font-style:italic; color:#000000;">clone</span><span style=" color:#000000;">()</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span><span style=" font-style:italic; color:#000000;">setData</span><span style=" color:#000000;">(</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span>role<span style=" color:#000000;">,</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>value<span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" font-style:italic; color:#000000;">data</span><span style=" color:#000000;">(</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span>role<span style=" color:#000000;">)</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>setFormula<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>formula<span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span>formula<span style=" color:#000000;">()</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span>setDirty<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">private</span><span style=" color:#000000;">:</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span>value<span style=" color:#000000;">()</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span>evalExpression<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>str<span style=" color:#000000;">,</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>pos<span style=" color:#000000;">)</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span>evalTerm<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>str<span style=" color:#000000;">,</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>pos<span style=" color:#000000;">)</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span>evalFactor<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>str<span style=" color:#000000;">,</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span>pos<span style=" color:#000000;">)</span><span style=" color:#808000;">const</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">mutable</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cachedValue</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">mutable</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cacheIsDirty</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">};</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000080;">#endif</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">//</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">CELL_H</span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#008000;"><br></span>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
//cell.cpp
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#008000;"><span style=" color:#000000;"> </span></span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#008000;"></span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000080;">#include</span><span style=" color:#008000;">&lt;QtGui&gt;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000080;">#include</span><span style=" color:#008000;">"cell.h"</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">(){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span>setDirty<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#800080;">QTableWidgetItem</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span><span style=" font-style:italic; color:#000000;">clone</span><span style=" color:#000000;">()</span><span style=" color:#808000;">const</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">new</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">(*</span><span style=" color:#808000;">this</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span>setFormula<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span><span style=" color:#000000;">formula</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" font-style:italic; color:#000000;">setData</span><span style=" color:#000000;">(</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">EditRole</span><span style=" color:#000000;">,</span><span style=" color:#000000;">formula</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span>formula<span style=" color:#000000;">()</span><span style=" color:#808000;">const</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" font-style:italic; color:#000000;">data</span><span style=" color:#000000;">(</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">EditRole</span><span style=" color:#000000;">).</span>toString<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span><span style=" font-style:italic; color:#000000;">setData</span><span style=" color:#000000;">(</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">role</span><span style=" color:#000000;">,</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span><span style=" color:#000000;">value</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QTableWidgetItem</span><span style=" color:#000000;">::</span><span style=" font-style:italic; color:#000000;">setData</span><span style=" color:#000000;">(</span><span style=" color:#000000;">role</span><span style=" color:#000000;">,</span><span style=" color:#000000;">value</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">role</span><span style=" color:#000000;">==</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">EditRole</span><span style=" color:#000000;">)</span>setDirty<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">void</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span>setDirty<span style=" color:#000000;">(){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cacheIsDirty</span><span style=" color:#000000;">=</span><span style=" color:#808000;">true</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span><span style=" font-style:italic; color:#000000;">data</span><span style=" color:#000000;">(</span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">role</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">const</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">role</span><span style=" color:#000000;">==</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">DisplayRole</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span>value<span style=" color:#000000;">().</span>isValid<span style=" color:#000000;">()){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span>value<span style=" color:#000000;">().</span>toString<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">"####"</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">role</span><span style=" color:#000000;">==</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">TextAlignmentRole</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span>value<span style=" color:#000000;">().</span>type<span style=" color:#000000;">()==</span><span style=" color:#800080;">QVariant</span><span style=" color:#000000;">::</span><span style=" color:#800080;">String</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">int</span><span style=" color:#000000;">(</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">AlignLeft</span><span style=" color:#000000;">|</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">AlignVCenter</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">int</span><span style=" color:#000000;">(</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">AlignRight</span><span style=" color:#000000;">|</span><span style=" color:#800080;">Qt</span><span style=" color:#000000;">::</span><span style=" color:#800080;">AlignVCenter</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QTableWidgetItem</span><span style=" color:#000000;">::</span><span style=" font-style:italic; color:#000000;">data</span><span style=" color:#000000;">(</span><span style=" color:#000000;">role</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span>Invalid<span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span>value<span style=" color:#000000;">()</span><span style=" color:#808000;">const</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#800000;">cacheIsDirty</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cacheIsDirty</span><span style=" color:#000000;">=</span><span style=" color:#808000;">false</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">formulaStr</span><span style=" color:#000000;">=</span>formula<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">formulaStr</span><span style=" color:#000000;">.</span>startsWith<span style=" color:#000000;">(</span><span style=" color:#008000;">'''</span><span style=" color:#000000;">)){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cachedValue</span><span style=" color:#000000;">=</span><span style=" color:#000000;">formulaStr</span><span style=" color:#000000;">.</span>mid<span style=" color:#000000;">(</span><span style=" color:#000080;">1</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">formulaStr</span><span style=" color:#000000;">.</span>startsWith<span style=" color:#000000;">(</span><span style=" color:#008000;">'='</span><span style=" color:#000000;">)){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cachedValue</span><span style=" color:#000000;">=</span>Invalid<span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">expr</span><span style=" color:#000000;">=</span><span style=" color:#000000;">formulaStr</span><span style=" color:#000000;">.</span>mid<span style=" color:#000000;">(</span><span style=" color:#000080;">1</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">expr</span><span style=" color:#000000;">.</span>replace<span style=" color:#000000;">(</span><span style=" color:#008000;">"</span><span style=" color:#c0c0c0;"> </span><span style=" color:#008000;">"</span><span style=" color:#000000;">,</span><span style=" color:#008000;">""</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">expr</span><span style=" color:#000000;">.</span>append<span style=" color:#000000;">(</span><span style=" color:#800080;">QChar</span><span style=" color:#000000;">::</span><span style=" color:#800080;">Null</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">pos</span><span style=" color:#000000;">=</span><span style=" color:#000080;">0</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cachedValue</span><span style=" color:#000000;">=</span>evalExpression<span style=" color:#000000;">(</span><span style=" color:#000000;">expr</span><span style=" color:#000000;">,</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">expr</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">]!=</span><span style=" color:#800080;">QChar</span><span style=" color:#000000;">::</span><span style=" color:#800080;">Null</span><span style=" color:#000000;">)</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cachedValue</span><span style=" color:#000000;">=</span>Invalid<span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">ok</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">double</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">d</span><span style=" color:#000000;">=</span><span style=" color:#000000;">formulaStr</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">(&amp;</span><span style=" color:#000000;">ok</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">ok</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cachedValue</span><span style=" color:#000000;">=</span><span style=" color:#000000;">d</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cachedValue</span><span style=" color:#000000;">=</span><span style=" color:#000000;">formulaStr</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800000;">cachedValue</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span>evalExpression<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span><span style=" color:#000000;">str</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">const</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span>evalTerm<span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">,</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">while</span><span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">]!=</span><span style=" color:#800080;">QChar</span><span style=" color:#000000;">::</span><span style=" color:#800080;">Null</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QChar</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">op</span><span style=" color:#000000;">=</span><span style=" color:#000000;">str</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">];</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">op</span><span style=" color:#000000;">!=</span><span style=" color:#008000;">'+'</span><span style=" color:#000000;">&amp;&amp;</span><span style=" color:#000000;">op</span><span style=" color:#000000;">!=</span><span style=" color:#008000;">'-'</span><span style=" color:#000000;">)</span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">++</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">term</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span>evalTerm<span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">,</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">result</span><span style=" color:#000000;">.</span>type<span style=" color:#000000;">()==</span><span style=" color:#800080;">QVariant</span><span style=" color:#000000;">::</span><span style=" color:#800080;">Double</span><span style=" color:#000000;">&amp;&amp;</span><span style=" color:#000000;">term</span><span style=" color:#000000;">.</span>type<span style=" color:#000000;">()==</span><span style=" color:#800080;">QVariant</span><span style=" color:#000000;">::</span><span style=" color:#800080;">Double</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">op</span><span style=" color:#000000;">==</span><span style=" color:#008000;">'+'</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span><span style=" color:#000000;">result</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">()+</span><span style=" color:#000000;">term</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span><span style=" color:#000000;">result</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">()-</span><span style=" color:#000000;">term</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span>Invalid<span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span>evalTerm<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span><span style=" color:#000000;">str</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">const</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span>evalFactor<span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">,</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">while</span><span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">]!=</span><span style=" color:#800080;">QChar</span><span style=" color:#000000;">::</span><span style=" color:#800080;">Null</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QChar</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">op</span><span style=" color:#000000;">=</span><span style=" color:#000000;">str</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">];</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">op</span><span style=" color:#000000;">!=</span><span style=" color:#008000;">'*'</span><span style=" color:#000000;">&amp;&amp;</span><span style=" color:#000000;">op</span><span style=" color:#000000;">!=</span><span style=" color:#008000;">'/'</span><span style=" color:#000000;">)</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">++</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">factor</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">=</span>evalFactor<span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">,</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">result</span><span style=" color:#000000;">.</span>type<span style=" color:#000000;">()==</span><span style=" color:#800080;">QVariant</span><span style=" color:#000000;">::</span><span style=" color:#800080;">Double</span><span style=" color:#000000;">&amp;&amp;</span><span style=" color:#000000;">factor</span><span style=" color:#000000;">.</span>type<span style=" color:#000000;">()==</span><span style=" color:#800080;">QVariant</span><span style=" color:#000000;">::</span><span style=" color:#800080;">Double</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">op</span><span style=" color:#000000;">==</span><span style=" color:#008000;">'*'</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span><span style=" color:#000000;">result</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">()*</span><span style=" color:#000000;">factor</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">factor</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">()==</span><span style=" color:#000080;">0.0</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span>Invalid<span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span><span style=" color:#000000;">result</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">()/</span><span style=" color:#000000;">factor</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span>Invalid<span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">::</span>evalFactor<span style=" color:#000000;">(</span><span style=" color:#808000;">const</span><span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span><span style=" color:#000000;">str</span><span style=" color:#000000;">,</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">&amp;</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">)</span><span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">const</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QVariant</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">negative</span><span style=" color:#000000;">=</span><span style=" color:#808000;">false</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">]==</span><span style=" color:#008000;">'-'</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">negative</span><span style=" color:#000000;">=</span><span style=" color:#808000;">true</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">++</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">]==</span><span style=" color:#008000;">'('</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">++</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span>evalExpression<span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">,</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">]!=</span><span style=" color:#008000;">')'</span><span style=" color:#000000;">)</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span>Invalid<span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QRegExp</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">regExp</span><span style=" color:#000000;">(</span><span style=" color:#008000;">"[A-Za-z][0-9]{0,2}"</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">QString</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">token</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">while</span><span style=" color:#000000;">(</span><span style=" color:#000000;">str</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">].</span>isLetterOrNumber<span style=" color:#000000;">()||</span><span style=" color:#000000;">str</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">]==</span><span style=" color:#008000;">'.'</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">token</span><span style=" color:#000000;">+=</span><span style=" color:#000000;">str</span><span style=" color:#000000;">[</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">];</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">++</span><span style=" color:#000000;">pos</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">regExp</span><span style=" color:#000000;">.</span>exactMatch<span style=" color:#000000;">(</span><span style=" color:#000000;">token</span><span style=" color:#000000;">)){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">column</span><span style=" color:#000000;">=</span><span style=" color:#000000;">token</span><span style=" color:#000000;">[</span><span style=" color:#000080;">0</span><span style=" color:#000000;">].</span>toUpper<span style=" color:#000000;">().</span>unicode<span style=" color:#000000;">()-</span><span style=" color:#008000;">'A'</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">int</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">row</span><span style=" color:#000000;">=</span><span style=" color:#000000;">token</span><span style=" color:#000000;">.</span>mid<span style=" color:#000000;">(</span><span style=" color:#000080;">1</span><span style=" color:#000000;">).</span>toInt<span style=" color:#000000;">()-</span><span style=" color:#000080;">1</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#800080;">Cell</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">*</span><span style=" color:#000000;">c</span><span style=" color:#000000;">=</span><span style=" color:#808000;">static_cast</span><span style=" color:#000000;">&lt;</span><span style=" color:#800080;">Cell</span><span style=" color:#000000;">*&gt;(</span>tableWidget<span style=" color:#000000;">()-&gt;</span>item<span style=" color:#000000;">(</span><span style=" color:#000000;">row</span><span style=" color:#000000;">,</span><span style=" color:#000000;">column</span><span style=" color:#000000;">));</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">c</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span><span style=" color:#000000;">c</span><span style=" color:#000000;">-&gt;</span>value<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span><span style=" color:#000080;">0.0</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">bool</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">ok</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span><span style=" color:#000000;">token</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">(&amp;</span><span style=" color:#000000;">ok</span><span style=" color:#000000;">);</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(!</span><span style=" color:#000000;">ok</span><span style=" color:#000000;">)</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span>Invalid<span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">negative</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">if</span><span style=" color:#000000;">(</span><span style=" color:#000000;">result</span><span style=" color:#000000;">.</span>type<span style=" color:#000000;">()==</span><span style=" color:#800080;">QVariant</span><span style=" color:#000000;">::</span><span style=" color:#800080;">Double</span><span style=" color:#000000;">){</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=-</span><span style=" color:#000000;">result</span><span style=" color:#000000;">.</span>toDouble<span style=" color:#000000;">();</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span><span style=" color:#808000;">else</span><span style=" color:#000000;">{</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">=</span>Invalid<span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#c0c0c0;"> </span><span style=" color:#808000;">return</span><span style=" color:#c0c0c0;"> </span><span style=" color:#000000;">result</span><span style=" color:#000000;">;</span>
</pre> 
          <pre>
</pre> 
          <pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
<span style=" color:#000000;">}</span>
</pre> 
          <pre>
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
          <pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">
</pre> 
         </div> 
        </div>
       </div>
       <!-- .entry-content --> 
       <!-- .entry-meta --> 
      </article>
      <!-- #post-58 --> 
      <!-- #comments --> 
     </div>
     <!-- #content --> 
    </div>
    <!-- #primary --> 
    <!-- #secondary .widget-area --> 
   </div>
   <!-- #main --> 
   <!-- #colophon --> 
  </div>
  <!-- #page -->   
  <!-- JiaThis Button BEGIN -->  
  <!-- JiaThis Button END -->   
 </body>
</html>