<!doctype html>
<!--[if IE 6]>
<html id="ie6" lang="zh-CN">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="zh-CN">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="zh-CN">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="zh-CN">
 <!--<![endif]-->
 <head>      
  <link rel="stylesheet" type="text/css" media="all" href="stylesheets/style.css">     
  <link rel="stylesheet" id="codebox-css" href="stylesheets/codebox.css" type="text/css" media="screen">             
 </head> 
 <body class="single single-post postid-142 single-format-standard content-sidebar"> 
  <div id="page" class="hfeed"> 
   <header id="branding" role="banner"> 
    <hgroup> 
     <h1 id="site-title"><span><a href="http://codelifeliwan.github.io/" title="Code_Life_LiWan" rel="home">Code_Life_LiWan</a></span></h1> 
     <h2 id="site-description">My heart will go on and on…</h2> 
    </hgroup>  
    <!-- #access --> 
   </header>
   <!-- #branding --> 
   <div id="main" class="clearfix"> 
    <div id="primary"> 
     <div id="content" role="main"> 
      <!-- #nav-single --> 
      <article id="post-142" class="post-142 post type-post status-publish format-standard hentry category-acm tag-uva"> 
       <header class="entry-header"> 
        <h1 class="entry-title">UVA&nbsp;348&nbsp;–&nbsp;Optimal&nbsp;Array&nbsp;Multiplication&nbsp;Sequence&nbsp;解题报告</h1> 
        <div class="entry-meta"> 
         <span class="sep">Posted on </span>
         <a href="http://codelifeliwan.github.io/?p=142" title="下午 3:17" rel="bookmark"><time class="entry-date" datetime="2011-08-12T15:17:08+00:00" pubdate>12 八月, 2011</time></a>
         <span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://codelifeliwan.github.io/?author=1" title="View all posts by wanli" rel="author">wanli</a></span></span> 
         <span class="sep"> — </span> 
         <span class="comments-link"> <a href="http://codelifeliwan.github.io/?p=142#respond" title="Comment on UVA&nbsp;348&nbsp;–&nbsp;Optimal&nbsp;Array&nbsp;Multiplication&nbsp;Sequence&nbsp;解题报告">No Comments ↓</a> </span> 
        </div>
        <!-- .entry-meta --> 
       </header>
       <!-- .entry-header --> 
       <div class="entry-content">
        <div class="entry-content"> 
         <p> 最优矩阵链乘问题（DP）</p> 
         <div>
           此处给出记忆化搜索递归算法。 
         </div> 
         <div></div> 
         <div>
           题目： 
         </div> 
         <div> 
          <table bgcolor="#0060F0"> 
           <tbody> 
            <tr> 
             <td><b><a name="SECTION0001000000000000000000"><font color="#C0FFFF" size="5">Optimal Array Multiplication<br> Sequence</font></a>&nbsp;<wbr></b></td> 
            </tr> 
           </tbody> 
          </table> 
          <p>Given two arrays <i>A</i> and <i>B</i>, we can determine the<br> array <i>C</i> = <i>A</i> <i>B</i> using the standard definition of<br> matrix multiplication:</p> 
          <p></p> 
          <center> 
           <img src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img13.gif" alt="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"> 
           <wbr>348&nbsp; 
           <wbr>-&nbsp; 
           <wbr>Optimal&nbsp; 
           <wbr>Array&nbsp; 
           <wbr>Multiplication&nbsp; 
           <wbr>Sequence&nbsp; 
           <wbr>解题报告” TITLE=”UVA&nbsp; 
           <wbr>348&nbsp; 
           <wbr>-&nbsp; 
           <wbr>Optimal&nbsp; 
           <wbr>Array&nbsp; 
           <wbr>Multiplication&nbsp; 
           <wbr>Sequence&nbsp; 
           <wbr>解题报告” /&gt; 
          </center> 
          <p></p> 
          <p>The number of columns in the <i>A</i> array must be the same as<br> the number of rows in the <i>B</i> array. Notationally, let’s say<br> that <i>rows</i>(<i>A</i>) and <i>columns</i>(<i>A</i>) are the<br> number of rows and columns, respectively, in the <i>A</i> array.<br> The number of individual multiplications required to compute the<br> entire <i>C</i> array (which will have the same number of rows as<br> <i>A</i> and the same number of columns as <i>B</i>) is then<br> <i>rows</i>(<i>A</i>) <i>columns</i>(<i>B</i>)<br> <i>columns</i>(<i>A</i>). For example, if <i>A</i> is a <img alt="tex2html_wrap_inline67" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img1.gif" height="24" width="54" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; array, and <i>B</i> is a <img alt="tex2html_wrap_inline71" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img2.gif" height="24" width="55" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; array, it will take <img alt="tex2html_wrap_inline73" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img3.gif" height="24" width="93" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; , or 3000 multiplications to compute<br> the <i>C</i> array.</p> 
          <p>To perform multiplication of more than two arrays we have a<br> choice of how to proceed. For example, if <i>X</i>, <i>Y</i>, and<br> <i>Z</i> are arrays, then to compute <i>X</i> <i>Y</i> <i>Z</i> we<br> could either compute (<i>X</i> <i>Y</i>) <i>Z</i> or <i>X</i><br> (<i>Y</i> <i>Z</i>). Suppose <i>X</i> is a <img alt="tex2html_wrap_inline103" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img4.gif" height="24" width="46" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; array, <i>Y</i> is a <img alt="tex2html_wrap_inline67" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img1.gif" height="24" width="54" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; array, and <i>Z</i> is a <img alt="tex2html_wrap_inline111" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img5.gif" height="24" width="54" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; array. Let’s look at the number of<br> multiplications required to compute the product using the two<br> different sequences:</p> 
          <p>(<i>X</i> <i>Y</i>) <i>Z</i></p> 
          <ul> 
           <li><img alt="tex2html_wrap_inline119" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img6.gif" height="24" width="143" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; multiplications to determine the<br> product (<i>X Y</i>), a <img alt="tex2html_wrap_inline123" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img7.gif" height="24" width="46" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; array.</li> 
           <li>Then <img alt="tex2html_wrap_inline125" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img8.gif" height="24" width="143" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; multiplications to determine the<br> final result.</li> 
           <li>Total multiplications: 4500.</li> 
          </ul> 
          <p><i>X</i> (<i>Y</i> <i>Z</i>)</p> 
          <ul> 
           <li><img alt="tex2html_wrap_inline133" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img9.gif" height="24" width="151" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; multiplications to determine the<br> product (<i>Y</i> <i>Z</i>), a <img alt="tex2html_wrap_inline139" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img10.gif" height="24" width="55" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; array.</li> 
           <li>Then <img alt="tex2html_wrap_inline141" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img11.gif" height="24" width="142" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; multiplications to determine the<br> final result.</li> 
           <li>Total multiplications: 8750.</li> 
          </ul> 
          <p>Clearly we’ll be able to compute (<i>X</i> <i>Y</i>) <i>Z</i><br> using fewer individual multiplications.</p> 
          <p>Given the size of each array in a sequence of arrays to be<br> multiplied, you are to determine an optimal computational sequence.<br> Optimality, for this problem, is relative to the number of<br> individual multiplications required.</p> 
          <h2><a name="SECTION0001001000000000000000"><font color="#0070E8">Input</font></a></h2> 
          <p>For each array in the multiple sequences of arrays to be<br> multiplied you will be given only the dimensions of the array. Each<br> sequence will consist of an integer <i>N</i> which indicates the<br> number of arrays to be multiplied, and then <i>N</i> pairs of<br> integers, each pair giving the number of rows and columns in an<br> array; the order in which the dimensions are given is the same as<br> the order in which the arrays are to be multiplied. A value of zero<br> for <i>N</i> indicates the end of the input. <i>N</i> will be no<br> larger than 10.</p> 
          <h2><a name="SECTION0001002000000000000000"><font color="#0070E8">Output</font></a></h2> 
          <p>Assume the arrays are named <img alt="tex2html_wrap_inline157" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" real_src="http://uva.onlinejudge.org/external/3/348img12.gif" height="25" width="109" align="middle" title="UVA&nbsp;<wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告"><wbr>348&nbsp;<wbr>-&nbsp;<wbr>Optimal&nbsp;<wbr>Array&nbsp;<wbr>Multiplication&nbsp;<wbr>Sequence&nbsp;<wbr>解题报告” /&gt; . Your output for each input<br> case is to be a line containing a parenthesized expression clearly<br> indicating the order in which the arrays are to be multiplied.<br> Prefix the output for each case with the case number (they are<br> sequentially numbered, starting with 1). Your output should<br> strongly resemble that shown in the samples shown below. If, by<br> chance, there are multiple correct sequences, any of these will be<br> accepted as a valid answer.</p> 
          <h2><a name="SECTION0001003000000000000000"><font color="#0070E8">Sample<br> Input</font></a></h2> 
          <pre>
3
</pre> 
          <pre>
1 5
</pre> 
          <pre>
5 20
</pre> 
          <pre>
20 1
</pre> 
          <pre>
3
</pre> 
          <pre>
5 10
</pre> 
          <pre>
10 20
</pre> 
          <pre>
20 35
</pre> 
          <pre>
6
</pre> 
          <pre>
30 35
</pre> 
          <pre>
35 15
</pre> 
          <pre>
15 5
</pre> 
          <pre>
5 10
</pre> 
          <pre>
10 20
</pre> 
          <pre>
20 25
</pre> 
          <pre>
0
</pre> 
          <h2><a name="SECTION0001004000000000000000"><font color="#0070E8">Sample<br> Output</font></a></h2> 
          <pre>
Case 1: (A1 x (A2 x A3))
</pre> 
          <pre>
Case 2: ((A1 x A2) x A3)
</pre> 
          <pre>
Case 3: ((A1 x (A2 x A3)) x ((A4 x A5) x A6))
</pre> 
          <div></div> 
          <div></div> 
          <div>
            代码： 
          </div> 
          <div> 
           <div></div> 
           <div>
             #include&lt;iostream&gt; 
           </div> 
           <div>
             #include&lt;cstring&gt; 
           </div> 
           <div>
             #include&lt;algorithm&gt; 
           </div> 
           <div>
             #include&lt;fstream&gt; 
           </div> 
           <div>
             #define INF 1&lt;&lt;31-1 
           </div> 
           <div>
             using namespace std; 
           </div> 
           <div>
             typedef struct node{ 
           </div> 
           <div>
             int x; 
           </div> 
           <div>
             int y; 
           </div> 
           <div>
             }node; 
           </div> 
           <div>
             node N[10]; 
           </div> 
           <div>
             node record[10]; 
           </div> 
           <div>
             int vis[10][10]; 
           </div> 
           <div>
             int path[10][10]; 
           </div> 
           <div>
             int r; 
           </div> 
           <div>
             int num; 
           </div> 
           <div></div> 
           <div>
             void Printpath(int i,int j) 
           </div> 
           <div>
             &nbsp; 
            <wbr>{ 
           </div> 
           <div>
             &nbsp; 
            <wbr> &nbsp; 
            <wbr> &nbsp; 
            <wbr> 
            <br> if(i==j)cout&lt;&lt;“A”&lt;&lt;i+1; 
           </div> 
           <div>
             &nbsp; 
            <wbr> &nbsp; 
            <wbr> &nbsp; 
            <wbr> 
            <br> else 
           </div> 
           <div>
             &nbsp; 
            <wbr> &nbsp; 
            <wbr> &nbsp; 
            <wbr> 
            <br> { 
           </div> 
           <div>
             &nbsp; 
            <wbr> &nbsp; 
            <wbr> &nbsp; 
            <wbr> 
            <br> &nbsp; 
            <wbr> 
            <br> &nbsp; 
            <wbr>cout&lt;&lt;“(“; 
           </div> 
           <div>
             &nbsp; 
            <wbr> &nbsp; 
            <wbr> &nbsp; 
            <wbr> 
            <br> &nbsp; 
            <wbr> &nbsp; 
            <wbr>Printpath(i,path[i][j]); 
           </div> 
           <div>
             &nbsp; 
            <wbr> &nbsp; 
            <wbr> &nbsp; 
            <wbr> 
            <br> &nbsp; 
            <wbr> 
            <br> &nbsp; 
            <wbr>cout&lt;&lt;” x “; 
           </div> 
           <div>
             &nbsp; 
            <wbr> &nbsp; 
            <wbr> &nbsp; 
            <wbr> 
            <br> &nbsp; 
            <wbr> 
            <br> &nbsp; 
            <wbr>Printpath(path[i][j]+1,j); 
           </div> 
           <div>
             &nbsp; 
            <wbr> &nbsp; 
            <wbr> &nbsp; 
            <wbr> 
            <br> &nbsp; 
            <wbr> 
            <br> &nbsp; 
            <wbr>cout&lt;&lt;“)”; 
           </div> 
           <div>
             &nbsp; 
            <wbr> &nbsp; 
            <wbr> &nbsp; 
            <wbr> 
            <br> } 
           </div> 
           <div>
             &nbsp; 
            <wbr>} 
           </div> 
           <div></div> 
           <div>
             int dp(int begin,int end){ 
           </div> 
           <div>
             if(begin&gt;=end)return 0; 
           </div> 
           <div>
             int &amp;re=vis[begin][end]; 
           </div> 
           <div>
             if(re!=0)return re; 
           </div> 
           <div>
             re=INF; 
           </div> 
           <div>
             for(int i=0;i&lt;end-begin;i++){ 
           </div> 
           <div>
             int 
            <br> tmp=dp(begin,begin+i)+dp(begin+i+1,end)+N[begin].x*N[begin+i].y*N[end].y; 
           </div> 
           <div>
             if(tmp&lt;re){ 
           </div> 
           <div>
             re=tmp; 
           </div> 
           <div>
             path[begin][end]=begin+i; 
           </div> 
           <div>
             } 
           </div> 
           <div>
             } 
           </div> 
           <div>
             return re; 
           </div> 
           <div>
             } 
           </div> 
           <div></div> 
           <div>
             int main() 
           </div> 
           <div>
             { 
           </div> 
           <div>
             // freopen(“test.txt”,”r”,stdin); 
           </div> 
           <div>
             int ncase=0; 
           </div> 
           <div>
             while(cin&gt;&gt;num&amp;&amp;num){ 
           </div> 
           <div>
             ncase++; 
           </div> 
           <div>
             cout&lt;&lt;“Case 
            <br> “&lt;&lt;ncase&lt;&lt;“: 
            <br> “; 
           </div> 
           <div>
             for(int i=0;i&lt;num;i++){ 
           </div> 
           <div>
             cin&gt;&gt;N[i].x&gt;&gt;N[i].y; 
           </div> 
           <div>
             } 
           </div> 
           <div>
             r=0; 
           </div> 
           <div>
             memset(vis,0,sizeof(vis)); 
           </div> 
           <div>
             memset(path,0,sizeof(path)); 
           </div> 
           <div>
             int re=dp(0,num-1); 
           </div> 
           <div>
             Printpath(0,num-1); 
           </div> 
           <div>
             cout&lt;&lt;endl; 
           </div> 
           <div>
             } 
           </div> 
           <div>
             return 0; 
           </div> 
           <div>
             } 
           </div> 
          </div> 
          <div></div> 
         </div> 
        </div>
       </div>
       <!-- .entry-content --> 
       <!-- .entry-meta --> 
      </article>
      <!-- #post-142 --> 
      <!-- #comments --> 
     </div>
     <!-- #content --> 
    </div>
    <!-- #primary --> 
    <!-- #secondary .widget-area --> 
   </div>
   <!-- #main --> 
   <!-- #colophon --> 
  </div>
  <!-- #page -->   
  <!-- JiaThis Button BEGIN -->  
  <!-- JiaThis Button END -->   
 </body>
</html>